from typing import List
import urllib.request
import os

bucket_path = "https://egobody3m-bucket-1.s3.us-west-1.amazonaws.com"

sequences = [ '148625961194245', '914791923195465', '550161470517914', '1280549189485390', '1388781751918048', '251558964110148', '893080591897388', 
              '546562460657586', '1268075804140567', '734442398299052', '947433883288650', '502331015448340', '223378066862748', '928583328174691', 
              '1465415310932407', '945485200227199', '1940862649590415', '723458349452798', '776780933376047', '761833285370142', '208740225147390', 
              '236855638769366', '603778748449547', '159669686892803', '5927312250722406', '228508612978015', '1373477543193247', '5833641646753700', 
              '601199368160366', '712650933889927', '6027043407356565', '915545216235131', '3505934849641108', '927006518713380', '1973881816287467', 
              '112704988432319', '193656673302704', '742311100936194', '1292171961383345', '767536747818705', '921898932491196', '658927816035869', 
              '904909837500066', '1270491547009626', '507421371361323', '901462124310074', '1850638241960199', '890234288921356', '234845675642676', 
              '516232234005085', '3438472539807010', '1342850989890418', '878700180077225', '1636224163499658', '563948672359701', '163613063265006', 
              '935036394300591', '172112965583744', '918218595970115', '1565333150618147', '750367853143386', '1853605725000257', '2163691207159938', 
              '874831030479818', '171067801954151', '222283960349695', '1837429863304802', '593242142677254', '147052158273989', '612547960205951', 
              '791488839217850', '1372303106869874', '880896269839741', '565585918970920', '1258865085060056', '140231532295468', '982677596035014', 
              '544279564504044', '1933385170339694', '1144070139545461', '3562417110659405', '1268677514072606', '1237940800476096', '157758943789313', 
              '1447773462627427', '110732841964970', '1356618428508490', '536124131883793', '689448479602303', '568339225257462', '581843390559850', 
              '1145777406117314', '223998066687512', '1910318379319326', '673966801194449', '797583701925898', '919077399439117', '759126402233235', 
              '1178848666098893', '108858522154106', '1135079743830070', '530840815775361', '206888448664270', '1107032947357672', '226948409822515', 
              '217039554211134', '937647847269034', '726863915581236', '1248964165991920', '172471372218302', '1205122543476801', '1012312553073626', 
              '873777043718881', '8841084772629623', '924192258613890', '938487244256666', '6372448709440867', '113176415064646', '891184265461839', 
              '923115909013017', '1224609314849520', '913861973157720', '185288404275673', '3157210947921527', '174826764879376', '2206916246175867', 
              '222499650448368', '1218435325445544', '1663499790788079', '587961310027259', '766347571580537', '1627243984381307', '213237734695183', 
              '1734524763616351', '628099085993492', '760908578635622', '1338552036878303', '959700198546059', '165542853006250', '648102943990415', 
              '3535779983326877', '2221854421333090', '179629404817539', '3373770279541022', '732731661797211', '757183795713115', '876604440094107', 
              '162260209960852', '1402688183807478', '234341072351904', '762633988400308', '3241250549498705', '213108884608253', '588846689800991', 
              '197385099579880', '572551978164773', '557805499664836', '157858337116997', '764872174807763', '1322302118346635', '1350471612473703', 
              '552261030051022', '611559976967225', '1794838660917400', '752624746477160', '1000616830920551', '917736139546487', '182324607852665', 
              '6192053294151194', '901310604354614', '915118899830750', '1252962118990510', '1642666962828964', '607699481246161', '2431173007038810', 
              '598506205505853', '6174131409289848']

out_path = "./dataset"
os.makedirs("dataset", exist_ok=True)

for sequence in sequences:
    img_path = sequence + ".images.zip"
    meta_path = sequence + ".metadata.zip"

    full_img_path = bucket_path + "/" + img_path
    full_meta_path = bucket_path + "/" + meta_path

    print (f"Sequence {sequence}")

    print (f"   Loading images from '{full_img_path}'")
    urllib.request.urlretrieve(full_img_path, os.path.join(out_path, img_path))

    print (f"   Loading metadata from '{full_meta_path}'")
    urllib.request.urlretrieve(full_meta_path, os.path.join(out_path, img_path))

